(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{243:function(t,e,a){"use strict";a.r(e);var i=a(42),l=Object(i.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"paper-a-critique-of-ansi-sql-isolation-levels-笔记"}},[t._v("Paper: A critique of ANSI SQL isolation levels 笔记")]),t._v(" "),a("h4",{attrs:{id:"p1-dirty-read-脏读"}},[t._v("P1(Dirty Read): 脏读")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("w1[x] ... r2[x] ...\n")])])]),a("ul",[a("li",[t._v("txn1 修改了一行数据。（未 commit 之前）")]),t._v(" "),a("li",[t._v("txn2 读到修改的值。（未commit 之前）")])]),t._v(" "),a("h4",{attrs:{id:"p2-fuzz-or-non-repeatable-read-不可重读"}},[t._v("P2(Fuzz or Non-repeatable Read): 不可重读")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("r1[x] ... w2[x] ... c2 ... r1[x] ... c1\n")])])]),a("ul",[a("li",[t._v("txn1 读了一个数据，")]),t._v(" "),a("li",[t._v("txn2 修改这个数据，并 commit")]),t._v(" "),a("li",[t._v("txn1 重新读这个数据，读到新的值。")])]),t._v(" "),a("h4",{attrs:{id:"p3-phantom-幻读"}},[t._v("P3(Phantom): 幻读")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("r1[P] ... w2[y in P] ... c2 ... r1[P] ... c1\n")])])]),a("ul",[a("li",[t._v("txn1 读了一段满足某个 condition 的数据，")]),t._v(" "),a("li",[t._v("txn2 修改了一条数据，使之满足或者不满足这个 condition（比如说删掉了一条满足 condition 的数据，新增了一条满足 condition 数据），并 commit。")]),t._v(" "),a("li",[t._v("txn1 重新读满足这个 condition 的数据，返回数据变化。")])]),t._v(" "),a("p",[t._v("P2 可以看做是 P3 的特殊 case。")]),t._v(" "),a("h4",{attrs:{id:"p0-dirty-write-脏写"}},[t._v("P0(Dirty Write): 脏写")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("w1[x] ... w2[x] ... ((c1 or a1) and (c2 or a2) in any order)\n")])])]),a("ul",[a("li",[t._v("txn1 修改了一条数据。")]),t._v(" "),a("li",[t._v("txn2 再次修改同一条数据。")])]),t._v(" "),a("p",[t._v("txn2 应该 abort 或者 等待 txn1 结束。否则会破坏数据约束。")]),t._v(" "),a("p",[t._v("比如： "),a("code",[t._v("w1[x = 10] w2[x = 20] w2[y = 20] c2 w1[y = 10] c1")]),t._v(" 会违背 x = y 这个约束。")]),t._v(" "),a("p",[t._v("论文给出：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Isolation Level")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("P0: Dirty Write")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("P1: Dirty Read")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("P2: Fuzzy Read")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("P3: Phantom")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("READ UNCOMMITTED")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("READ COMMITTED")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("REPEATABLE READ")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Possible")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("SERIALIZABLE")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("Not Possible")])])])]),t._v(" "),a("p",[t._v("但是还有其他的 anomaly !!!")]),t._v(" "),a("h4",{attrs:{id:"p4-lost-update"}},[t._v("P4(Lost Update):")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("r1[x] ... r2[x] ... w2[x] ... w1[x] ... c1 ... c2\n")])])]),a("ul",[a("li",[t._v("txn1 读了一条数据。")]),t._v(" "),a("li",[t._v("txn2 读了并修改了这条数据。")]),t._v(" "),a("li",[t._v("txn1 修改这条数据，然后 commit。")]),t._v(" "),a("li",[t._v("txn2 commit。")])]),t._v(" "),a("p",[t._v("txn1 做的修改不见了。")]),t._v(" "),a("h4",{attrs:{id:"a5a-read-skew-读偏斜"}},[t._v("A5A(Read Skew): 读偏斜")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("r1[x]...w2[x]...w2[y]...c2...r1[y]...(c1 or a1)\n")])])]),a("ul",[a("li",[t._v("txn1 读了 x。")]),t._v(" "),a("li",[t._v("txn2 写了 x 和 y，然后 commit。")]),t._v(" "),a("li",[t._v("txn1 再读 y，读到新值。")])]),t._v(" "),a("p",[t._v("txn 读到的 x，y 不满足某个约束（比如 x==y）。")]),t._v(" "),a("h4",{attrs:{id:"a5b-write-skew-写偏斜"}},[t._v("A5B(Write Skew): 写偏斜")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("r1[x]...r2[y]...w1[y] ...w2[x]...(c1 and c2)\n")])])]),a("ul",[a("li",[t._v("txn1 读了x。")]),t._v(" "),a("li",[t._v("txn2 读了 y。")]),t._v(" "),a("li",[t._v("txn1 写了 y。")]),t._v(" "),a("li",[t._v("txn2 写了 x。")]),t._v(" "),a("li",[t._v("两个 txn 做 commit。")])]),t._v(" "),a("p",[t._v("最后 x，y 可能不满足某个约束。比如（x+y=2）")])])},[],!1,null,null,null);l.options.__file="README.md";e.default=l.exports}}]);